{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/pages/LoginPage.jsx"],"sourcesContent":["// frontend/src/pages/LoginPage.jsx\r\n\r\nimport React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, Link } from 'react-router-dom'; // Use React Router's Link\r\n\r\n// Normalize API base: allow NEXT_PUBLIC_API_URL to be either host or host+/api/v1\r\nconst _RAW_API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\nconst API_BASE_URL = /\\/api\\/v1\\/?$/.test(_RAW_API) ? _RAW_API.replace(/\\/$/, '') : _RAW_API.replace(/\\/$/, '') + '/api/v1';\r\n\r\nconst LoginPage = () => {\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const handleLogin = async (e) => {\r\n        e.preventDefault();\r\n        setError(null);\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            const response = await axios.post(`${API_BASE_URL}/auth/login`, {\r\n                username,\r\n                password,\r\n            });\r\n\r\n            localStorage.setItem('token', response.data.token);\r\n            localStorage.setItem('user', JSON.stringify(response.data.user));\r\n\r\n            const { token, user } = response.data;\r\n            \r\n            // --- Crucial Step: Store the JWT securely ---\r\n            // Storing in localStorage is acceptable for an MVP/testing environment.\r\n            // For production, consider using HttpOnly cookies for better security.\r\n            localStorage.setItem('authToken', token);\r\n            localStorage.setItem('userRole', user.role); \r\n\r\n            console.log(`User ${user.username} logged in successfully.`);\r\n\r\n            // Redirect the user to the main dashboard page\r\n            navigate('/dashboard'); \r\n\r\n        } catch (err) {\r\n            console.error('Login failed:', err);\r\n            // Display friendly error message\r\n            setError(err.response?.data?.error || 'Login failed. Check server connection.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex items-center justify-center min-h-screen bg-gray-100\">\r\n            <div className=\"w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-lg\">\r\n                <h2 className=\"text-2xl font-bold text-center text-indigo-800\">No Bed Syndrome Tracker Login</h2>\r\n                \r\n                <form onSubmit={handleLogin} className=\"space-y-4\">\r\n                    \r\n                    {/* Username Field */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Username</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={username}\r\n                            onChange={(e) => setUsername(e.target.value)}\r\n                            required\r\n                            className=\"mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\"\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* Password Field */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Password</label>\r\n                        <input\r\n                            type=\"password\"\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            required\r\n                            className=\"mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\"\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* Error Message */}\r\n                    {error && (\r\n                        <p className=\"text-sm font-medium text-red-600\">{error}</p>\r\n                    )}\r\n\r\n                    {/* Submit Button */}\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={isLoading}\r\n                        className=\"w-full py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\r\n                    >\r\n                        {isLoading ? 'Logging In...' : 'Login'}\r\n                    </button>\r\n                    <Link to=\"/forgot-password\" title=\"Reset Password\" className=\"text-sm text-indigo-600 hover:underline block\">\r\n                        Forgot password?\r\n                    </Link>\r\n                    <Link to=\"/signup\" className=\"text-blue-600 font-bold\">\r\n                        Register New Account\r\n                    </Link>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LoginPage;"],"names":[],"mappings":";;;;;AAAA,mCAAmC;AAEnC;AACA;AACA,8UAAsD,0BAA0B;;;;;;;;;AAEhF,kFAAkF;AAClF,MAAM,WAAW,+EAAmC;AACpD,MAAM,eAAe,gBAAgB,IAAI,CAAC,YAAY,SAAS,OAAO,CAAC,OAAO,MAAM,SAAS,OAAO,CAAC,OAAO,MAAM;AAElH,MAAM,YAAY;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IACzC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAC3C,MAAM,WAAW,IAAA,iNAAW;IAE5B,MAAM,cAAc,OAAO;QACvB,EAAE,cAAc;QAChB,SAAS;QACT,aAAa;QAEb,IAAI;YACA,MAAM,WAAW,MAAM,iKAAK,CAAC,IAAI,CAAC,GAAG,aAAa,WAAW,CAAC,EAAE;gBAC5D;gBACA;YACJ;YAEA,aAAa,OAAO,CAAC,SAAS,SAAS,IAAI,CAAC,KAAK;YACjD,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,SAAS,IAAI,CAAC,IAAI;YAE9D,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,SAAS,IAAI;YAErC,+CAA+C;YAC/C,wEAAwE;YACxE,uEAAuE;YACvE,aAAa,OAAO,CAAC,aAAa;YAClC,aAAa,OAAO,CAAC,YAAY,KAAK,IAAI;YAE1C,QAAQ,GAAG,CAAC,CAAC,KAAK,EAAE,KAAK,QAAQ,CAAC,wBAAwB,CAAC;YAE3D,+CAA+C;YAC/C,SAAS;QAEb,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC,iBAAiB;YAC/B,iCAAiC;YACjC,SAAS,IAAI,QAAQ,EAAE,MAAM,SAAS;QAC1C,SAAU;YACN,aAAa;QACjB;IACJ;IAEA,qBACI,qKAAC;QAAI,WAAU;kBACX,cAAA,qKAAC;YAAI,WAAU;;8BACX,qKAAC;oBAAG,WAAU;8BAAiD;;;;;;8BAE/D,qKAAC;oBAAK,UAAU;oBAAa,WAAU;;sCAGnC,qKAAC;;8CACG,qKAAC;oCAAM,WAAU;8CAA0C;;;;;;8CAC3D,qKAAC;oCACG,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,QAAQ;oCACR,WAAU;;;;;;;;;;;;sCAKlB,qKAAC;;8CACG,qKAAC;oCAAM,WAAU;8CAA0C;;;;;;8CAC3D,qKAAC;oCACG,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,QAAQ;oCACR,WAAU;;;;;;;;;;;;wBAKjB,uBACG,qKAAC;4BAAE,WAAU;sCAAoC;;;;;;sCAIrD,qKAAC;4BACG,MAAK;4BACL,UAAU;4BACV,WAAU;sCAET,YAAY,kBAAkB;;;;;;sCAEnC,qKAAC,0MAAI;4BAAC,IAAG;4BAAmB,OAAM;4BAAiB,WAAU;sCAAgD;;;;;;sCAG7G,qKAAC,0MAAI;4BAAC,IAAG;4BAAU,WAAU;sCAA0B;;;;;;;;;;;;;;;;;;;;;;;AAO3E;uCAEe"}},
    {"offset": {"line": 192, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/ConfirmationModal.jsx"],"sourcesContent":["// frontend/src/components/ConfirmationModal.jsx\r\nimport React from 'react';\r\n\r\nconst ConfirmationModal = ({ isOpen, onClose, onConfirm, title, message }) => {\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 transform transition-all scale-100\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4\">\r\n                        <span className=\"text-red-600 text-xl font-bold\">‚ö†Ô∏è</span>\r\n                    </div>\r\n                    <h3 className=\"text-lg font-bold text-gray-900 mb-2\">{title}</h3>\r\n                    <p className=\"text-sm text-gray-500 mb-6\">{message}</p>\r\n                </div>\r\n                <div className=\"flex gap-3\">\r\n                    <button \r\n                        onClick={onClose}\r\n                        className=\"flex-1 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg font-medium transition-colors\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button \r\n                        onClick={onConfirm}\r\n                        className=\"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors shadow-sm\"\r\n                    >\r\n                        Confirm Delete\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ConfirmationModal;"],"names":[],"mappings":";;;;;AAAA,gDAAgD;AAChD;;;AAEA,MAAM,oBAAoB,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE;IACrE,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACI,qKAAC;QAAI,WAAU;kBACX,cAAA,qKAAC;YAAI,WAAU;;8BACX,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAI,WAAU;sCACX,cAAA,qKAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;sCAErD,qKAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,qKAAC;4BAAE,WAAU;sCAA8B;;;;;;;;;;;;8BAE/C,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BACG,SAAS;4BACT,WAAU;sCACb;;;;;;sCAGD,qKAAC;4BACG,SAAS;4BACT,WAAU;sCACb;;;;;;;;;;;;;;;;;;;;;;;AAOrB;uCAEe"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/AdmissionModal.jsx"],"sourcesContent":["// frontend/src/components/AdmissionModal.jsx\r\nimport React, { useState } from 'react';\r\n\r\nconst AdmissionModal = ({ isOpen, onClose, onConfirm, bedNumber }) => {\r\n    const [patientName, setPatientName] = useState('');\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleConfirm = () => {\r\n        if (!patientName.trim()) {\r\n            alert(\"Please enter a patient name.\");\r\n            return;\r\n        }\r\n        onConfirm(patientName);\r\n        setPatientName(''); // Reset for next time\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6\">\r\n                <div className=\"text-center mb-6\">\r\n                    <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\">\r\n                        <span className=\"text-green-600 text-xl font-bold\">üë§</span>\r\n                    </div>\r\n                    <h3 className=\"text-xl font-bold text-gray-900\">Direct Admission</h3>\r\n                    <p className=\"text-sm text-gray-500\">Assigning patient to Bed {bedNumber}</p>\r\n                </div>\r\n\r\n                <div className=\"mb-6\">\r\n                    <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Patient Full Name</label>\r\n                    <input \r\n                        autoFocus\r\n                        type=\"text\"\r\n                        className=\"w-full border-2 border-gray-100 p-3 rounded-lg outline-none focus:border-green-500 transition-colors\"\r\n                        placeholder=\"Enter name...\"\r\n                        value={patientName}\r\n                        onChange={(e) => setPatientName(e.target.value)}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"flex gap-3\">\r\n                    <button onClick={onClose} className=\"flex-1 px-4 py-2 bg-gray-100 text-gray-800 rounded-lg font-medium\">\r\n                        Cancel\r\n                    </button>\r\n                    <button onClick={handleConfirm} className=\"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium shadow-md\">\r\n                        Confirm Admission\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdmissionModal;"],"names":[],"mappings":";;;;;AAAA,6CAA6C;AAC7C;;;AAEA,MAAM,iBAAiB,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE;IAC7D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,+GAAQ,EAAC;IAE/C,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,gBAAgB;QAClB,IAAI,CAAC,YAAY,IAAI,IAAI;YACrB,MAAM;YACN;QACJ;QACA,UAAU;QACV,eAAe,KAAK,sBAAsB;IAC9C;IAEA,qBACI,qKAAC;QAAI,WAAU;kBACX,cAAA,qKAAC;YAAI,WAAU;;8BACX,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAI,WAAU;sCACX,cAAA,qKAAC;gCAAK,WAAU;0CAAmC;;;;;;;;;;;sCAEvD,qKAAC;4BAAG,WAAU;sCAAkC;;;;;;sCAChD,qKAAC;4BAAE,WAAU;;gCAAwB;gCAA0B;;;;;;;;;;;;;8BAGnE,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAM,WAAU;sCAAuD;;;;;;sCACxE,qKAAC;4BACG,SAAS;4BACT,MAAK;4BACL,WAAU;4BACV,aAAY;4BACZ,OAAO;4BACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;8BAItD,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAO,SAAS;4BAAS,WAAU;sCAAoE;;;;;;sCAGxG,qKAAC;4BAAO,SAAS;4BAAe,WAAU;sCAA+F;;;;;;;;;;;;;;;;;;;;;;;AAO7J;uCAEe"}},
    {"offset": {"line": 433, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/BedHistory.jsx"],"sourcesContent":["// frontend/src/components/BedHistory.jsx\r\nimport React from 'react';\r\n\r\nconst BedHistory = ({ history }) => (\r\n    <div className=\"mt-6 border-t pt-4\">\r\n        <h4 className=\"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2\">\r\n            üïí Recent Bed Activity\r\n        </h4>\r\n        <div className=\"space-y-2 max-h-40 overflow-y-auto pr-2\">\r\n            {history.length === 0 ? (\r\n                <p className=\"text-xs text-gray-400 italic\">No recent history</p>\r\n            ) : (\r\n                history.map((log, i) => (\r\n                    <div key={i} className=\"text-[11px] flex justify-between bg-gray-50 p-2 rounded border-l-2 border-indigo-400\">\r\n                        <div>\r\n                            <span className=\"font-bold text-indigo-900\">{log.action_type}</span>: {log.patient_name}\r\n                        </div>\r\n                        <div className=\"text-gray-400\">\r\n                            {new Date(log.timestamp).toLocaleDateString()}\r\n                        </div>\r\n                    </div>\r\n                ))\r\n            )}\r\n        </div>\r\n    </div>\r\n);\r\n\r\nexport default BedHistory;"],"names":[],"mappings":";;;;;AAAA,yCAAyC;AACzC;;;AAEA,MAAM,aAAa,CAAC,EAAE,OAAO,EAAE,iBAC3B,qKAAC;QAAI,WAAU;;0BACX,qKAAC;gBAAG,WAAU;0BAAgE;;;;;;0BAG9E,qKAAC;gBAAI,WAAU;0BACV,QAAQ,MAAM,KAAK,kBAChB,qKAAC;oBAAE,WAAU;8BAA+B;;;;;+DAE5C,QAAQ,GAAG,CAAC,CAAC,KAAK,kBACd,qKAAC;wBAAY,WAAU;;0CACnB,qKAAC;;kDACG,qKAAC;wCAAK,WAAU;kDAA6B,IAAI,WAAW;;;;;;oCAAQ;oCAAG,IAAI,YAAY;;;;;;;0CAE3F,qKAAC;gCAAI,WAAU;0CACV,IAAI,KAAK,IAAI,SAAS,EAAE,kBAAkB;;;;;;;uBALzC;;;;;;;;;;;;;;;;uCAcf"}},
    {"offset": {"line": 515, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/BedCard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport ConfirmationModal from './ConfirmationModal';\r\nimport AdmissionModal from './AdmissionModal';\r\nimport BedHistory from './BedHistory';\r\n\r\n// const API_BASE_URL = 'http://localhost:3000/api/v1';\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000/api/v1';\r\n\r\nconst BedCard = ({ bedData, onStatusChange, token, userRole }) => {\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const [isAdmissionModalOpen, setIsAdmissionModalOpen] = useState(false);\r\n    const [isDischargeModalOpen, setIsDischargeModalOpen] = useState(false);\r\n    const [history, setHistory] = useState([]);\r\n    const [status, setStatus] = useState(bedData.current_status);\r\n    const bedId = bedData.bed_id;\r\n\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n        const fetchHistory = async () => {\r\n            try {\r\n                const res = await axios.get(`${API_BASE_URL}/beds/${bedId}/history`, {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                });\r\n                if (isMounted) setHistory(res.data);\r\n            } catch (err) { \r\n                // If the backend isn't ready, just set history to empty so the UI doesn't break\r\n                if (err.response?.status === 404) {\r\n                    console.warn(\"History endpoint not found on server yet.\");\r\n                    setHistory([]); \r\n                }\r\n            };\r\n        };\r\n\r\n        fetchHistory();\r\n        setStatus(bedData.current_status);\r\n        \r\n        return () => { isMounted = false; };\r\n    }, [bedData.current_status, bedId, token]);\r\n\r\n    // --- API HANDLERS ---\r\n\r\n    const handleAdmission = async (patientName) => {\r\n        try {\r\n            await axios.post(`${API_BASE_URL}/beds/${bedId}/status`, \r\n                { \r\n                    new_status: 'OCCUPIED', \r\n                    patient_name: patientName, // Explicitly pass name\r\n                    performed_by: userRole \r\n                },\r\n                { headers: { 'Authorization': `Bearer ${token}` } }\r\n            );\r\n            onStatusChange();\r\n            setIsAdmissionModalOpen(false);\r\n        } catch (error) { alert('Admission failed.'); }\r\n    };\r\n\r\n    const handleDischarge = async () => {\r\n        try {\r\n            // When discharging, we explicitly clear the patient_name in the DB\r\n            await axios.post(`${API_BASE_URL}/beds/${bedId}/status`,\r\n                { \r\n                    new_status: 'CLEANING',\r\n                    patient_name: null // Clear the name upon discharge\r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            onStatusChange();\r\n            setIsDischargeModalOpen(false);\r\n        } catch (err) { alert('Discharge failed.'); }\r\n    };\r\n\r\n    const handleMarkClean = async () => {\r\n        try {\r\n            await axios.post(`${API_BASE_URL}/beds/${bedId}/status`,\r\n                { new_status: 'AVAILABLE' },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            onStatusChange();\r\n        } catch (err) { alert('Could not mark bed clean.'); }\r\n    };\r\n\r\n    const handleDelete = async () => {\r\n        try {\r\n            await axios.delete(`${API_BASE_URL}/beds/${bedId}`, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            onStatusChange();\r\n            setIsDeleteModalOpen(false);\r\n        } catch (err) { alert('Delete failed. Discharge Patient First'); }\r\n    };\r\n\r\n    // --- UI HELPERS ---\r\n    const isLongStay = () => {\r\n        if (status !== 'OCCUPIED' || !bedData.updated_at) return false;\r\n        return (new Date() - new Date(bedData.updated_at)) / (1000 * 60 * 60) >= 48;\r\n    };\r\n\r\n    const getCardStyle = () => {\r\n        let base = \"\";\r\n        switch (status) {\r\n            case 'AVAILABLE': base = 'bg-emerald-50 text-emerald-800 border-emerald-200'; break;\r\n            case 'OCCUPIED': base = 'bg-rose-50 text-rose-800 border-rose-200'; break;\r\n            case 'CLEANING': base = 'bg-amber-50 text-amber-800 border-amber-200'; break;\r\n            default: base = 'bg-gray-50 text-gray-800 border-gray-200';\r\n        }\r\n        if (bedData.specialty_type === 'Maternity') base += ' border-l-8 border-l-pink-400';\r\n        if (bedData.specialty_type === 'ICU') base += ' border-l-8 border-l-indigo-600';\r\n        if (isLongStay()) base += ' ring-2 ring-rose-500 ring-offset-2';\r\n        return base;\r\n    };\r\n\r\n    return (\r\n        <div className={`p-5 border-2 rounded-xl shadow-sm transition-all flex flex-col justify-between relative min-h-[340px] ${getCardStyle()}`}>\r\n            \r\n            {/* ALERT OVERLAYS */}\r\n            {isLongStay() && (\r\n                <div className=\"absolute -top-3 left-4 bg-rose-600 text-white text-[10px] font-bold px-2 py-1 rounded shadow-lg animate-bounce z-20\">\r\n                    ‚ö†Ô∏è LONG STAY {'> 48 hrs'}\r\n                </div>\r\n            )}\r\n            \r\n            {userRole?.toUpperCase() === 'ADMIN' && (\r\n                <button onClick={() => setIsDeleteModalOpen(true)} className=\"absolute top-3 right-3 p-2 bg-white/60 hover:bg-rose-500 hover:text-white text-rose-600 rounded-full transition-all z-30 shadow-sm border border-rose-100\">\r\n                    <span className=\"text-sm\">üóëÔ∏è</span>\r\n                </button>\r\n            )}\r\n\r\n            {/* MODALS */}\r\n            <AdmissionModal \r\n                isOpen={isAdmissionModalOpen} \r\n                onClose={() => setIsAdmissionModalOpen(false)} \r\n                onConfirm={handleAdmission} \r\n                bedNumber={bedData.bed_number} \r\n            />\r\n            \r\n            <ConfirmationModal \r\n                isOpen={isDischargeModalOpen} \r\n                onClose={() => setIsDischargeModalOpen(false)} \r\n                onConfirm={handleDischarge} \r\n                title=\"Confirm Discharge\" \r\n                message={`Discharge ${bedData.patient_name || 'Patient'}? Bed will move to CLEANING.`} \r\n            />\r\n\r\n            <ConfirmationModal \r\n                isOpen={isDeleteModalOpen} \r\n                onClose={() => setIsDeleteModalOpen(false)} \r\n                onConfirm={handleDelete} \r\n                title=\"Delete Bed\" \r\n                message=\"Permanently remove this bed from inventory?\" \r\n            />\r\n\r\n            {/* CARD CONTENT */}\r\n            <div>\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                    <h3 className=\"font-black text-xl text-slate-900 tracking-tight\">Bed {bedData.bed_number}</h3>\r\n                    <span className=\"text-[9px] uppercase font-black px-2 py-1 rounded-md border border-current\">{status}</span>\r\n                </div>\r\n                \r\n                <div className=\"text-xs space-y-1 mb-4\">\r\n                    <p><span className=\"text-slate-400 font-bold uppercase text-[10px]\">Ward:</span> {bedData.ward_name}</p>\r\n                    <p><span className=\"text-slate-400 font-bold uppercase text-[10px]\">Type:</span> {bedData.specialty_type}</p>\r\n                </div>\r\n\r\n                {status === 'OCCUPIED' && (\r\n                    <div className=\"p-3 bg-white/90 rounded-lg border border-rose-100 shadow-sm mb-4\">\r\n                        <p className=\"text-[9px] uppercase font-bold text-rose-500 mb-0.5 tracking-tighter\">Current Patient</p>\r\n                        <p className=\"text-sm font-bold text-slate-900 truncate\">\r\n                            üë§ {bedData.patient_name || 'Anonymous'}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n\r\n                <BedHistory history={history} />\r\n            </div>\r\n            \r\n            {/* ACTION BUTTONS */}\r\n            <div className=\"mt-5 flex flex-col gap-2\">\r\n                {status === 'OCCUPIED' && (\r\n                    <button className=\"bg-rose-600 text-white font-bold py-2.5 rounded-lg text-xs hover:bg-rose-700 shadow-md transition-all active:scale-95\" \r\n                        onClick={() => setIsDischargeModalOpen(true)}>Discharge</button>\r\n                )}\r\n                {status === 'CLEANING' && (\r\n                    <button className=\"bg-amber-500 text-white font-bold py-2.5 rounded-lg text-xs hover:bg-amber-600 shadow-md transition-all active:scale-95\" \r\n                        onClick={handleMarkClean}>Mark Clean</button>\r\n                )}\r\n                {status === 'AVAILABLE' && (\r\n                    <button className=\"bg-emerald-600 text-white font-bold py-2.5 rounded-lg text-xs hover:bg-emerald-700 shadow-md transition-all active:scale-95\" \r\n                        onClick={() => setIsAdmissionModalOpen(true)}>Admit Patient</button>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BedCard;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 889, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/TransferRequestForm.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { TransferRequest, PriorityLevel } from '../types/transfer';\r\n\r\n// Normalize API base: allow NEXT_PUBLIC_API_URL to be either host or host+/api/v1\r\nconst _RAW_API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\nconst API_BASE_URL = /\\/api\\/v1\\/?$/.test(_RAW_API) ? _RAW_API.replace(/\\/$/, '') : _RAW_API.replace(/\\/$/, '') + '/api/v1';\r\nconst SPECIALTIES = ['General', 'ICU', 'Pediatric', 'HDU', 'CCU', 'NICU', 'Emergency beds', 'PACU', 'PICU', 'Maternity'];\r\nconst PRIORITIES: PriorityLevel[] = ['Low', 'Medium', 'High', 'Emergency'];\r\n\r\nconst TransferRequestForm: React.FC = () => {\r\n    const [formData, setFormData] = useState<TransferRequest>({\r\n        patient_name: '',\r\n        from_ward: '',\r\n        required_specialty: 'General',\r\n        priority: 'Medium',\r\n        clinical_notes: ''\r\n    });\r\n\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [message, setMessage] = useState<{ type: 'success' | 'error', text: string } | null>(null);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsSubmitting(true);\r\n        setMessage(null);\r\n\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            \r\n            // Critical check for that 401 error prevention\r\n            if (!token) {\r\n                setMessage({ type: 'error', text: 'Authentication missing. Please log in.' });\r\n                return;\r\n            }\r\n\r\n            await axios.post(`${API_BASE_URL}/transfers`, formData, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n\r\n            setMessage({ type: 'success', text: 'Transfer request logged and patient queued!' });\r\n            \r\n            // Reset form to original state\r\n            setFormData({ \r\n                patient_name: '', \r\n                from_ward: '', \r\n                required_specialty: 'General', \r\n                priority: 'Medium', \r\n                clinical_notes: '' \r\n            });\r\n\r\n        } catch (err: any) {\r\n            if (err.response?.status === 401) {\r\n                setMessage({ type: 'error', text: 'Session expired. Please refresh and log in.' });\r\n            } else {\r\n                setMessage({ type: 'error', text: 'Failed to submit request. Check connection.' });\r\n            }\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100\">\r\n            <div className=\"flex items-center gap-2 mb-6\">\r\n                <span className=\"text-xl\">üìã</span>\r\n                <h2 className=\"text-lg font-black text-slate-800 tracking-tight uppercase\">New Transfer</h2>\r\n            </div>\r\n            \r\n            <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n                {/* Patient Name - Maps to patient_name in DB */}\r\n                <div>\r\n                    <label className=\"block text-[10px] font-black text-slate-400 uppercase mb-1 ml-1\">Patient Identity</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Full Name or Hospital ID\"\r\n                        required\r\n                        className=\"w-full bg-slate-50 border-none rounded-xl p-3 text-sm focus:ring-2 focus:ring-indigo-500 transition-all outline-none\"\r\n                        value={formData.patient_name}\r\n                        onChange={(e) => setFormData({...formData, patient_name: e.target.value})}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                        <label className=\"block text-[10px] font-black text-slate-400 uppercase mb-1 ml-1\">Source Ward</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"e.g. A&E\"\r\n                            required\r\n                            className=\"w-full bg-slate-50 border-none rounded-xl p-3 text-sm focus:ring-2 focus:ring-indigo-500 transition-all outline-none\"\r\n                            value={formData.from_ward}\r\n                            onChange={(e) => setFormData({...formData, from_ward: e.target.value})}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-[10px] font-black text-slate-400 uppercase mb-1 ml-1\">Target Specialty</label>\r\n                        <select \r\n                            className=\"w-full bg-slate-50 border-none rounded-xl p-3 text-sm focus:ring-2 focus:ring-indigo-500 transition-all cursor-pointer font-bold outline-none\"\r\n                            value={formData.required_specialty}\r\n                            onChange={(e) => setFormData({...formData, required_specialty: e.target.value})}\r\n                        >\r\n                            {SPECIALTIES.map(s => <option key={s} value={s}>{s}</option>)}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Priority Toggle Buttons */}\r\n                <div>\r\n                    <label className=\"block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1\">Triage Priority</label>\r\n                    <div className=\"grid grid-cols-4 gap-2\">\r\n                        {PRIORITIES.map(p => (\r\n                            <button\r\n                                key={p}\r\n                                type=\"button\"\r\n                                onClick={() => setFormData({...formData, priority: p})}\r\n                                className={`py-2 rounded-lg text-[10px] font-black transition-all border ${\r\n                                    formData.priority === p \r\n                                    ? (p === 'Emergency' ? 'bg-rose-600 border-rose-600 text-white' : 'bg-indigo-600 border-indigo-600 text-white shadow-md shadow-indigo-100') \r\n                                    : 'bg-white border-slate-100 text-slate-400 hover:border-slate-300'\r\n                                }`}\r\n                            >\r\n                                {p.toUpperCase()}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-[10px] font-black text-slate-400 uppercase mb-1 ml-1\">Clinical Indication</label>\r\n                    <textarea\r\n                        placeholder=\"Reason for transfer (Handover notes)...\"\r\n                        className=\"w-full bg-slate-50 border-none rounded-xl p-3 text-sm focus:ring-2 focus:ring-indigo-500 transition-all resize-none outline-none\"\r\n                        rows={3}\r\n                        value={formData.clinical_notes}\r\n                        onChange={(e) => setFormData({...formData, clinical_notes: e.target.value})}\r\n                    />\r\n                </div>\r\n\r\n                {message && (\r\n                    <div className={`p-3 rounded-xl text-xs font-bold flex items-center gap-2 animate-in fade-in slide-in-from-top-1 ${\r\n                        message.type === 'success' ? 'bg-emerald-50 text-emerald-600' : 'bg-rose-50 text-rose-600'\r\n                    }`}>\r\n                        <span>{message.type === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}</span>\r\n                        {message.text}\r\n                    </div>\r\n                )}\r\n\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={isSubmitting}\r\n                    className=\"w-full bg-indigo-950 text-white py-4 rounded-xl font-black text-xs tracking-widest hover:bg-indigo-900 disabled:bg-slate-300 transition-all active:scale-[0.98] shadow-lg shadow-indigo-100/50\"\r\n                >\r\n                    {isSubmitting ? 'PROCESSING...' : 'DISPATCH REQUEST'}\r\n                </button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TransferRequestForm;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1234, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/TransferRequestList.tsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport { TransferRequest } from '../types/transfer';\r\n\r\n// NEXT_PUBLIC_API_URL should point to the API base (including `/api/v1`) in .env.local.\r\n// Fallback to localhost dev API if missing.\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000/api/v1';\r\n\r\ninterface Bed {\r\n    bed_id: number;\r\n    ward_name: string;\r\n    specialty_type: string;\r\n    current_status: string;\r\n}\r\n\r\nconst TransferRequestList: React.FC = () => {\r\n    const [requests, setRequests] = useState<TransferRequest[]>([]);\r\n    const [availableBeds, setAvailableBeds] = useState<Bed[]>([]);\r\n    const [selectedBeds, setSelectedBeds] = useState<Record<number, string>>({});\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const fetchBeds = useCallback(async () => {\r\n        const token = localStorage.getItem('authToken');\r\n        try {\r\n            const response = await axios.get(`${API_BASE_URL}/beds`, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            setAvailableBeds(response.data.filter((b: Bed) => b.current_status === 'AVAILABLE'));\r\n        } catch (err) {\r\n            console.error(\"Error fetching beds\", err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchRequests = useCallback(async () => {\r\n        const token = localStorage.getItem('authToken');\r\n        if (!token) return;\r\n\r\n        try {\r\n            const res = await axios.get(`${API_BASE_URL}/transfers`, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            // Filter only pending requests for this list\r\n            setRequests(res.data.filter((r: any) => r.status === 'PENDING' || !r.status));\r\n            setLoading(false);\r\n        } catch (err: any) {\r\n            if (err.response?.status === 401) {\r\n                console.warn(\"Session expired in List component\");\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchRequests();\r\n        fetchBeds();\r\n        const interval = setInterval(() => {\r\n            fetchRequests();\r\n            fetchBeds();\r\n        }, 15000); // Polling every 15s for \"Live\" feel\r\n        return () => clearInterval(interval);\r\n    }, [fetchRequests, fetchBeds]);\r\n\r\n    const handleAction = async (id: number, action: 'APPROVED' | 'REJECTED') => {\r\n        const token = localStorage.getItem('authToken');\r\n        const bedId = selectedBeds[id];\r\n\r\n        if (action === 'APPROVED' && !bedId) {\r\n            alert(\"Please assign a destination bed.\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await axios.patch(`${API_BASE_URL}/transfers/${id}`, \r\n                { \r\n                    new_status: action,\r\n                    assigned_bed_id: action === 'APPROVED' ? parseInt(bedId) : null \r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            // Instant refresh\r\n            fetchRequests();\r\n            fetchBeds();\r\n        } catch (err) {\r\n            alert(`${action} failed. Verify backend route exists.`);\r\n        }\r\n    };\r\n\r\n    if (loading && requests.length === 0) return <div className=\"p-10 text-center animate-pulse text-slate-400 font-bold uppercase tracking-widest\">Loading Requests...</div>;\r\n\r\n    return (\r\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden mt-6\">\r\n            <div className=\"p-6 border-b border-slate-50 flex justify-between items-center bg-slate-50/50\">\r\n                <h2 className=\"text-sm font-black text-slate-800 tracking-tighter uppercase flex items-center gap-2\">\r\n                    <span className=\"flex h-2 w-2 rounded-full bg-indigo-500 animate-pulse\"></span>\r\n                    Live Transfer Queue\r\n                </h2>\r\n                <span className=\"bg-indigo-100 text-indigo-700 text-[10px] font-black px-2 py-1 rounded-full\">\r\n                    {requests.length} PENDING\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n                <table className=\"min-w-full divide-y divide-slate-100\">\r\n                    <thead className=\"bg-slate-50/30\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-widest\">Patient Details</th>\r\n                            <th className=\"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-widest\">Priority</th>\r\n                            <th className=\"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-widest\">Requirement</th>\r\n                            <th className=\"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-widest\">Deployment</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-100\">\r\n                        {requests.map((req) => (\r\n                            <tr key={req.request_id} className={`transition-colors ${req.priority === 'Emergency' ? 'bg-rose-50/30' : 'hover:bg-slate-50/50'}`}>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                    <div className=\"text-sm font-bold text-slate-800 uppercase\">{req.patient_name}</div>\r\n                                    <div className=\"text-[10px] font-bold text-slate-400 uppercase tracking-tighter\">Location: {req.from_ward}</div>\r\n                                </td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                    <span className={`text-[10px] font-black px-2 py-1 rounded-md uppercase tracking-widest ${\r\n                                        req.priority === 'Emergency' ? 'bg-rose-600 text-white animate-pulse' : \r\n                                        req.priority === 'High' ? 'bg-orange-100 text-orange-600' : 'bg-slate-100 text-slate-600'\r\n                                    }`}>\r\n                                        {req.priority}\r\n                                    </span>\r\n                                </td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-[11px] font-bold text-slate-600 uppercase\">\r\n                                    {req.required_specialty}\r\n                                </td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap flex items-center gap-3\">\r\n                                    <select \r\n                                        className=\"text-[10px] font-black border-none bg-slate-100 rounded-lg p-2 outline-none focus:ring-2 focus:ring-indigo-500\"\r\n                                        value={selectedBeds[req.request_id || 0] || \"\"}\r\n                                        onChange={(e) => setSelectedBeds({...selectedBeds, [req.request_id || 0]: e.target.value})}\r\n                                    >\r\n                                        <option value=\"\">Select Bed</option>\r\n                                        {availableBeds\r\n                                            .filter(b => b.specialty_type === req.required_specialty)\r\n                                            .map(b => (\r\n                                                <option key={b.bed_id} value={b.bed_id}>\r\n                                                    BED {b.bed_id} ({b.ward_name})\r\n                                                </option>\r\n                                            ))\r\n                                        }\r\n                                    </select>\r\n\r\n                                    <div className=\"flex gap-1\">\r\n                                        <button \r\n                                            onClick={() => req.request_id && handleAction(req.request_id, 'APPROVED')}\r\n                                            className=\"p-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-all shadow-sm\"\r\n                                            title=\"Approve\"\r\n                                        >\r\n                                            ‚úÖ\r\n                                        </button>\r\n                                        <button \r\n                                            onClick={() => req.request_id && handleAction(req.request_id, 'REJECTED')}\r\n                                            className=\"p-2 bg-rose-100 text-rose-600 rounded-lg hover:bg-rose-600 hover:text-white transition-all\"\r\n                                            title=\"Reject\"\r\n                                        >\r\n                                            ‚úï\r\n                                        </button>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n                {requests.length === 0 && (\r\n                    <div className=\"text-center py-12\">\r\n                        <div className=\"text-3xl mb-2\">‚ú®</div>\r\n                        <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]\">Queue Clear - All Patients Assigned</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TransferRequestList;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1614, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/HospitalCensus.jsx"],"sourcesContent":["// frontend/src/components/HospitalCensus.jsx\r\n\r\nimport React from 'react';\r\n\r\nconst HospitalCensus = ({ beds }) => {\r\n    const total = beds.length;\r\n    const occupied = beds.filter(b => b.current_status === 'OCCUPIED').length;\r\n    const available = beds.filter(b => b.current_status === 'AVAILABLE').length;\r\n    \r\n    const occupancyRate = total > 0 ? Math.round((occupied / total) * 100) : 0;\r\n\r\n    // Group beds by specialty to create the breakdown\r\n    const specialtyData = beds.reduce((acc, bed) => {\r\n        const spec = bed.specialty_type;\r\n        if (!acc[spec]) acc[spec] = { total: 0, available: 0 };\r\n        acc[spec].total += 1;\r\n        if (bed.current_status === 'AVAILABLE') acc[spec].available += 1;\r\n        return acc;\r\n    }, {});\r\n\r\n    return (\r\n        <div className=\"space-y-6 mb-8\">\r\n            {/* Top Level Stats */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <div className=\"bg-indigo-900 text-white p-6 rounded-xl shadow-lg\">\r\n                    <p className=\"text-xs font-bold uppercase opacity-80\">Global Occupancy</p>\r\n                    <p className=\"text-4xl font-black\">{occupancyRate}%</p>\r\n                    <div className=\"w-full bg-indigo-700 h-2 mt-4 rounded-full overflow-hidden\">\r\n                        <div className=\"bg-white h-full\" style={{ width: `${occupancyRate}%` }}></div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-200\">\r\n                    <p className=\"text-xs font-bold text-gray-500 uppercase\">Available Beds</p>\r\n                    <p className=\"text-4xl font-black text-green-600\">{available}</p>\r\n                    <p className=\"text-sm text-gray-400 mt-2\">Ready for admissions</p>\r\n                </div>\r\n\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-200\">\r\n                    <p className=\"text-xs font-bold text-gray-500 uppercase\">Total Capacity</p>\r\n                    <p className=\"text-4xl font-black text-gray-800\">{total}</p>\r\n                    <p className=\"text-sm text-gray-400 mt-2\">Registered across all wards</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Specialty Breakdown Table */}\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\">\r\n                <div className=\"bg-gray-50 px-6 py-3 border-b\">\r\n                    <h3 className=\"text-sm font-bold text-gray-700 uppercase\">Specialty Capacity Breakdown</h3>\r\n                </div>\r\n                <table className=\"min-w-full divide-y divide-gray-200 text-sm\">\r\n                    <thead>\r\n                        <tr className=\"bg-gray-50\">\r\n                            <th className=\"px-6 py-2 text-left font-semibold text-gray-600\">Specialty</th>\r\n                            <th className=\"px-6 py-2 text-center font-semibold text-gray-600\">Available</th>\r\n                            <th className=\"px-6 py-2 text-center font-semibold text-gray-600\">Total</th>\r\n                            <th className=\"px-6 py-2 text-right font-semibold text-gray-600\">Status</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-100\">\r\n                        {Object.entries(specialtyData).map(([name, stats]) => (\r\n                            <tr key={name} className=\"hover:bg-gray-50\">\r\n                                <td className=\"px-6 py-2 font-medium text-gray-800\">{name}</td>\r\n                                <td className=\"px-6 py-2 text-center text-green-600 font-bold\">{stats.available}</td>\r\n                                <td className=\"px-6 py-2 text-center text-gray-500\">{stats.total}</td>\r\n                                <td className=\"px-6 py-2 text-right\">\r\n                                    <span className={`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${\r\n                                        stats.available === 0 ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'\r\n                                    }`}>\r\n                                        {stats.available === 0 ? 'Full' : 'Space'}\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HospitalCensus;"],"names":[],"mappings":";;;;;AAAA,6CAA6C;AAE7C;;;AAEA,MAAM,iBAAiB,CAAC,EAAE,IAAI,EAAE;IAC5B,MAAM,QAAQ,KAAK,MAAM;IACzB,MAAM,WAAW,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,cAAc,KAAK,YAAY,MAAM;IACzE,MAAM,YAAY,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,cAAc,KAAK,aAAa,MAAM;IAE3E,MAAM,gBAAgB,QAAQ,IAAI,KAAK,KAAK,CAAC,AAAC,WAAW,QAAS,OAAO;IAEzE,kDAAkD;IAClD,MAAM,gBAAgB,KAAK,MAAM,CAAC,CAAC,KAAK;QACpC,MAAM,OAAO,IAAI,cAAc;QAC/B,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,KAAK,GAAG;YAAE,OAAO;YAAG,WAAW;QAAE;QACrD,GAAG,CAAC,KAAK,CAAC,KAAK,IAAI;QACnB,IAAI,IAAI,cAAc,KAAK,aAAa,GAAG,CAAC,KAAK,CAAC,SAAS,IAAI;QAC/D,OAAO;IACX,GAAG,CAAC;IAEJ,qBACI,qKAAC;QAAI,WAAU;;0BAEX,qKAAC;gBAAI,WAAU;;kCACX,qKAAC;wBAAI,WAAU;;0CACX,qKAAC;gCAAE,WAAU;0CAAyC;;;;;;0CACtD,qKAAC;gCAAE,WAAU;;oCAAuB;oCAAc;;;;;;;0CAClD,qKAAC;gCAAI,WAAU;0CACX,cAAA,qKAAC;oCAAI,WAAU;oCAAkB,OAAO;wCAAE,OAAO,GAAG,cAAc,CAAC,CAAC;oCAAC;;;;;;;;;;;;;;;;;kCAI7E,qKAAC;wBAAI,WAAU;;0CACX,qKAAC;gCAAE,WAAU;0CAA4C;;;;;;0CACzD,qKAAC;gCAAE,WAAU;0CAAsC;;;;;;0CACnD,qKAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAG9C,qKAAC;wBAAI,WAAU;;0CACX,qKAAC;gCAAE,WAAU;0CAA4C;;;;;;0CACzD,qKAAC;gCAAE,WAAU;0CAAqC;;;;;;0CAClD,qKAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;;;;;;;0BAKlD,qKAAC;gBAAI,WAAU;;kCACX,qKAAC;wBAAI,WAAU;kCACX,cAAA,qKAAC;4BAAG,WAAU;sCAA4C;;;;;;;;;;;kCAE9D,qKAAC;wBAAM,WAAU;;0CACb,qKAAC;0CACG,cAAA,qKAAC;oCAAG,WAAU;;sDACV,qKAAC;4CAAG,WAAU;sDAAkD;;;;;;sDAChE,qKAAC;4CAAG,WAAU;sDAAoD;;;;;;sDAClE,qKAAC;4CAAG,WAAU;sDAAoD;;;;;;sDAClE,qKAAC;4CAAG,WAAU;sDAAmD;;;;;;;;;;;;;;;;;0CAGzE,qKAAC;gCAAM,WAAU;0CACZ,OAAO,OAAO,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,MAAM,MAAM,iBAC7C,qKAAC;wCAAc,WAAU;;0DACrB,qKAAC;gDAAG,WAAU;0DAAuC;;;;;;0DACrD,qKAAC;gDAAG,WAAU;0DAAkD,MAAM,SAAS;;;;;;0DAC/E,qKAAC;gDAAG,WAAU;0DAAuC,MAAM,KAAK;;;;;;0DAChE,qKAAC;gDAAG,WAAU;0DACV,cAAA,qKAAC;oDAAK,WAAW,CAAC,yDAAyD,EACvE,MAAM,SAAS,KAAK,IAAI,4BAA4B,+BACtD;8DACG,MAAM,SAAS,KAAK,IAAI,SAAS;;;;;;;;;;;;uCARrC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBrC;uCAEe"}},
    {"offset": {"line": 1911, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/components/AddBedForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst _RAW_API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\nconst API_BASE_URL = /\\/api\\/v1\\/?$/.test(_RAW_API) ? _RAW_API.replace(/\\/$/, '') : _RAW_API.replace(/\\/$/, '') + '/api/v1';\r\n\r\n// --- Default Ward Mapping ---\r\nconst WARD_MAPPING = {\r\n    'Maternity': 'Maternity Ward',\r\n    'ICU': 'Intensive Care Unit',\r\n    'NICU': 'Neonatal ICU',\r\n    'Pediatric': 'Children‚Äôs Wing',\r\n    'Emergency beds': 'Emergency Dept',\r\n    'General': 'General Ward'\r\n};\r\n\r\nconst AddBedForm = ({ onBedAdded, specialties }) => {\r\n    const [formData, setFormData] = useState({\r\n        bed_number: '', // Added this back as it's vital for your DB\r\n        ward_name: 'General Ward',\r\n        specialty_type: 'General',\r\n        current_status: 'AVAILABLE'\r\n    });\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const token = localStorage.getItem('authToken');\r\n\r\n    // --- AUTO-FILL LOGIC ---\r\n    // This runs whenever the specialty dropdown changes\r\n    useEffect(() => {\r\n        const defaultWard = WARD_MAPPING[formData.specialty_type];\r\n        if (defaultWard) {\r\n            setFormData(prev => ({ ...prev, ward_name: defaultWard }));\r\n        }\r\n    }, [formData.specialty_type]);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setIsSubmitting(true);\r\n        try {\r\n            await axios.post(`${API_BASE_URL}/beds`, formData, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            alert(\"New bed registered successfully!\");\r\n            // Keep the ward and specialty but clear the number for the next entry\r\n            setFormData({ ...formData, bed_number: '' }); \r\n            onBedAdded(); \r\n        } catch (err) {\r\n            alert(err.response?.data?.error || \"Error creating bed.\");\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-xl shadow-md border border-indigo-100\">\r\n            <h2 className=\"text-xl font-bold mb-4 flex items-center text-indigo-900\">\r\n                <span className=\"mr-2\">‚ûï</span> Register New Bed\r\n            </h2>\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                \r\n                {/* 1. Specialty Dropdown (The Trigger) */}\r\n                <div>\r\n                    <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-wider\">Specialty Type</label>\r\n                    <select \r\n                        className=\"w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-indigo-500 outline-none bg-gray-50 cursor-pointer\"\r\n                        value={formData.specialty_type}\r\n                        onChange={(e) => setFormData({...formData, specialty_type: e.target.value})}\r\n                    >\r\n                        {specialties.filter(s => s !== 'All').map(spec => (\r\n                            <option key={spec} value={spec}>{spec}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                    {/* 2. Bed Number */}\r\n                    <div>\r\n                        <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-wider\">Bed Number</label>\r\n                        <input \r\n                            type=\"text\" \r\n                            required\r\n                            placeholder=\"e.g. B-01\"\r\n                            className=\"w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-indigo-500 outline-none\"\r\n                            value={formData.bed_number}\r\n                            onChange={(e) => setFormData({...formData, bed_number: e.target.value})}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* 3. Ward Name (Auto-filled but editable) */}\r\n                    <div>\r\n                        <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-wider\">Ward Name</label>\r\n                        <input \r\n                            type=\"text\" \r\n                            required\r\n                            className=\"w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-indigo-500 outline-none bg-indigo-50 font-medium\"\r\n                            placeholder=\"Ward Name\"\r\n                            value={formData.ward_name}\r\n                            onChange={(e) => setFormData({...formData, ward_name: e.target.value})}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <button \r\n                    type=\"submit\" \r\n                    disabled={isSubmitting}\r\n                    className=\"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-all shadow-md disabled:bg-gray-400 disabled:shadow-none\"\r\n                >\r\n                    {isSubmitting ? 'Registering...' : 'Add Bed to Inventory'}\r\n                </button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AddBedForm;"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;AAEA,MAAM,WAAW,+EAAmC;AACpD,MAAM,eAAe,gBAAgB,IAAI,CAAC,YAAY,SAAS,OAAO,CAAC,OAAO,MAAM,SAAS,OAAO,CAAC,OAAO,MAAM;AAElH,+BAA+B;AAC/B,MAAM,eAAe;IACjB,aAAa;IACb,OAAO;IACP,QAAQ;IACR,aAAa;IACb,kBAAkB;IAClB,WAAW;AACf;AAEA,MAAM,aAAa,CAAC,EAAE,UAAU,EAAE,WAAW,EAAE;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;QACrC,YAAY;QACZ,WAAW;QACX,gBAAgB;QAChB,gBAAgB;IACpB;IACA,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAC;IACjD,MAAM,QAAQ,aAAa,OAAO,CAAC;IAEnC,0BAA0B;IAC1B,oDAAoD;IACpD,IAAA,gHAAS,EAAC;QACN,MAAM,cAAc,YAAY,CAAC,SAAS,cAAc,CAAC;QACzD,IAAI,aAAa;YACb,YAAY,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,WAAW;gBAAY,CAAC;QAC5D;IACJ,GAAG;QAAC,SAAS,cAAc;KAAC;IAE5B,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,gBAAgB;QAChB,IAAI;YACA,MAAM,iKAAK,CAAC,IAAI,CAAC,GAAG,aAAa,KAAK,CAAC,EAAE,UAAU;gBAC/C,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAChD;YACA,MAAM;YACN,sEAAsE;YACtE,YAAY;gBAAE,GAAG,QAAQ;gBAAE,YAAY;YAAG;YAC1C;QACJ,EAAE,OAAO,KAAK;YACV,MAAM,IAAI,QAAQ,EAAE,MAAM,SAAS;QACvC,SAAU;YACN,gBAAgB;QACpB;IACJ;IAEA,qBACI,qKAAC;QAAI,WAAU;;0BACX,qKAAC;gBAAG,WAAU;;kCACV,qKAAC;wBAAK,WAAU;kCAAO;;;;;;oBAAQ;;;;;;;0BAEnC,qKAAC;gBAAK,UAAU;gBAAc,WAAU;;kCAGpC,qKAAC;;0CACG,qKAAC;gCAAM,WAAU;0CAAiE;;;;;;0CAClF,qKAAC;gCACG,WAAU;gCACV,OAAO,SAAS,cAAc;gCAC9B,UAAU,CAAC,IAAM,YAAY;wCAAC,GAAG,QAAQ;wCAAE,gBAAgB,EAAE,MAAM,CAAC,KAAK;oCAAA;0CAExE,YAAY,MAAM,CAAC,CAAA,IAAK,MAAM,OAAO,GAAG,CAAC,CAAA,qBACtC,qKAAC;wCAAkB,OAAO;kDAAO;uCAApB;;;;;;;;;;;;;;;;kCAKzB,qKAAC;wBAAI,WAAU;;0CAEX,qKAAC;;kDACG,qKAAC;wCAAM,WAAU;kDAAiE;;;;;;kDAClF,qKAAC;wCACG,MAAK;wCACL,QAAQ;wCACR,aAAY;wCACZ,WAAU;wCACV,OAAO,SAAS,UAAU;wCAC1B,UAAU,CAAC,IAAM,YAAY;gDAAC,GAAG,QAAQ;gDAAE,YAAY,EAAE,MAAM,CAAC,KAAK;4CAAA;;;;;;;;;;;;0CAK7E,qKAAC;;kDACG,qKAAC;wCAAM,WAAU;kDAAiE;;;;;;kDAClF,qKAAC;wCACG,MAAK;wCACL,QAAQ;wCACR,WAAU;wCACV,aAAY;wCACZ,OAAO,SAAS,SAAS;wCACzB,UAAU,CAAC,IAAM,YAAY;gDAAC,GAAG,QAAQ;gDAAE,WAAW,EAAE,MAAM,CAAC,KAAK;4CAAA;;;;;;;;;;;;;;;;;;kCAKhF,qKAAC;wBACG,MAAK;wBACL,UAAU;wBACV,WAAU;kCAET,eAAe,mBAAmB;;;;;;;;;;;;;;;;;;AAKvD;uCAEe"}},
    {"offset": {"line": 2143, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/pages/DashboardPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport axios from 'axios';\r\nimport BedCard from '../components/BedCard';\r\nimport TransferRequestForm from '../components/TransferRequestForm';\r\nimport TransferRequestList from '../components/TransferRequestList';\r\nimport HospitalCensus from '../components/HospitalCensus';\r\nimport AddBedForm from '../components/AddBedForm';\r\nimport Head from 'next/head';\r\n\r\n\r\n// Normalize API base: allow NEXT_PUBLIC_API_URL to be either host or host+/api/v1\r\nconst _RAW_API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\nconst API_BASE_URL = /\\/api\\/v1\\/?$/.test(_RAW_API) ? _RAW_API.replace(/\\/$/, '') : _RAW_API.replace(/\\/$/, '') + '/api/v1';\r\n\r\nconst SPECIALTY_OPTIONS = [\r\n    'All', 'General', 'ICU', 'Pediatric', 'HDU', \r\n    'CCU', 'NICU', 'Emergency beds', 'PACU', 'PICU',\r\n    'Maternity'\r\n];\r\n\r\nconst AdminTools = ({ token }) => {\r\n    const [targetUser, setTargetUser] = useState('');\r\n    const [newPass, setNewPass] = useState('');\r\n    const [status, setStatus] = useState({ type: '', msg: '' });\r\n\r\n    const handleAdminReset = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            await axios.post(`${API_BASE_URL}/auth/admin-reset-password`, \r\n                { targetUsername: targetUser, newPassword: newPass },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setStatus({ type: 'success', msg: `Password for ${targetUser} updated successfully!` });\r\n            setTargetUser(''); setNewPass('');\r\n        } catch (err) {\r\n            setStatus({ type: 'error', msg: err.response?.data?.error || \"Reset failed\" });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <section className=\"bg-white p-6 rounded-xl shadow-sm border-2 border-red-50 mt-10\">\r\n            <h2 className=\"text-xl font-bold text-red-700 mb-2 flex items-center\">\r\n                <span className=\"mr-2\">üîê</span> Admin: Staff Password Override\r\n            </h2>\r\n            <p className=\"text-sm text-gray-500 mb-4\">Manual override for staff experiencing 401 Authentication errors.</p>\r\n            {status.msg && (\r\n                <div className={`mb-4 p-3 rounded-lg text-sm font-bold ${status.type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>\r\n                    {status.msg}\r\n                </div>\r\n            )}\r\n            <form onSubmit={handleAdminReset} className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <input \r\n                    placeholder=\"Exact Username\" \r\n                    className=\"border p-2 rounded-lg outline-none focus:ring-2 focus:ring-red-400\"\r\n                    value={targetUser} required\r\n                    onChange={(e) => setTargetUser(e.target.value)}\r\n                />\r\n                <input \r\n                    type=\"password\"\r\n                    placeholder=\"New Secure Password\" \r\n                    className=\"border p-2 rounded-lg outline-none focus:ring-2 focus:ring-red-400\"\r\n                    value={newPass} required\r\n                    onChange={(e) => setNewPass(e.target.value)}\r\n                />\r\n                <button className=\"bg-red-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-red-700 transition-all shadow-md\">\r\n                    Update Credentials\r\n                </button>\r\n            </form>\r\n        </section>\r\n    );\r\n};\r\n\r\nconst DashboardPage = () => {\r\n    const [beds, setBeds] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [selectedSpecialty, setSelectedSpecialty] = useState('All');\r\n    const [isOnline, setIsOnline] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [showAll, setShowAll] = useState(false);\r\n    const [showSessionModal, setShowSessionModal] = useState(false);\r\n    \r\n    axios.interceptors.response.use(\r\n        (response) => response,\r\n        (error) => {\r\n            if (error.response && error.response.status === 401) {\r\n                setShowSessionModal(true);\r\n                localStorage.clear(); // Wipe the bad/expired token\r\n            }\r\n            return Promise.reject(error);\r\n        }\r\n    );\r\n\r\n    const BED_LIMIT = 6;\r\n    const user = useMemo(() => JSON.parse(localStorage.getItem('user') || '{}'), []);\r\n    const token = localStorage.getItem('authToken');\r\n\r\n    // --- SYSTEM MONITORING ---\r\n    useEffect(() => {\r\n        const checkConnection = async () => {\r\n            try {\r\n                await axios.get(`${API_BASE_URL}/beds`, { headers: { Authorization: `Bearer ${token}` } });\r\n                setIsOnline(true);\r\n            } catch { setIsOnline(false); }\r\n        };\r\n        const interval = setInterval(checkConnection, 15000);\r\n        return () => clearInterval(interval);\r\n    }, [token]);\r\n\r\n    const fetchBedData = useCallback(async (specialty) => {\r\n        setIsLoading(true);\r\n        setError(null);\r\n        try {\r\n            let url = `${API_BASE_URL}/beds`;\r\n            if (specialty && specialty !== 'All') url += `?specialty_type=${specialty}`;\r\n            \r\n            const response = await axios.get(url, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            setBeds(response.data);\r\n        } catch (err) {\r\n            if (err.response?.status === 401) setError(\"Session expired. Please log in again.\");\r\n            else setError('Could not load bed data.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [token]);\r\n\r\n    useEffect(() => {\r\n        if (token) fetchBedData(selectedSpecialty);\r\n        else window.location.href = '/';\r\n    }, [selectedSpecialty, fetchBedData, token]);\r\n\r\n    // --- COMPUTED STATS ---\r\n    const stats = useMemo(() => ({\r\n        total: beds.length,\r\n        available: beds.filter(b => b.current_status === 'AVAILABLE').length,\r\n        occupied: beds.filter(b => b.current_status === 'OCCUPIED').length,\r\n        cleaning: beds.filter(b => b.current_status === 'CLEANING').length\r\n    }), [beds]);\r\n\r\n    const filteredBeds = beds.filter(bed => \r\n        bed.bed_number?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        bed.patient_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        bed.ward_name?.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    const visibleBeds = showAll ? filteredBeds : filteredBeds.slice(0, BED_LIMIT);\r\n\r\n    const exportCensusToCSV = () => {\r\n        const occupied = beds.filter(b => b.current_status === 'OCCUPIED');\r\n        if (occupied.length === 0) return alert(\"No patients to export.\");\r\n\r\n        const headers = [\"Bed\", \"Ward\", \"Specialty\", \"Patient\", \"Last Update\"];\r\n        const rows = occupied.map(b => [b.bed_number, b.ward_name, b.specialty_type, b.patient_name || \"N/A\", new Date(b.updated_at).toLocaleString()]);\r\n        const csvContent = [headers.join(\",\"), ...rows.map(r => r.join(\",\"))].join(\"\\n\");\r\n\r\n        const blob = new Blob([csvContent], { type: 'text/csv' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement(\"a\");\r\n        link.href = url;\r\n        link.download = `Census_${new Date().toISOString().split('T')[0]}.csv`;\r\n        link.click();\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        localStorage.clear();\r\n        window.location.href = '/';\r\n    };\r\n\r\n    if (error) return (\r\n        <div className=\"flex items-center justify-center h-screen bg-gray-100 p-4\">\r\n            <div className=\"bg-white p-8 rounded-2xl shadow-2xl border border-red-200 text-center max-w-md w-full\">\r\n                <p className=\"text-red-600 font-black text-2xl mb-2\">‚ö†Ô∏è Access Denied</p>\r\n                <p className=\"text-gray-500 mb-6\">{error}</p>\r\n                <button onClick={handleLogout} className=\"w-full bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700 shadow-lg\">Return to Login</button>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <>\r\n        <Head>\r\n            <title>No Bed Syndrome Tracker</title>\r\n            <meta name=\"description\" content=\"Dashboard for monitoring hospital bed availability and patient admissions.\" />\r\n        </Head>\r\n        <div className=\"min-h-screen bg-slate-50\">\r\n            {/* STICKY HEADER */}\r\n            <header className=\"bg-indigo-950 text-white p-4 shadow-xl flex justify-between items-center sticky top-0 z-50 border-b border-indigo-800\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <h1 className=\"text-xl font-black tracking-tighter flex items-center gap-2\">\r\n                        <span className=\"bg-white text-indigo-900 p-1 rounded\">üè•</span> NO BED SYNDROME\r\n                    </h1>\r\n                    <div className=\"hidden md:flex items-center gap-2 px-3 py-1 bg-white/10 rounded-full\">\r\n                        <div className={`h-2 w-2 rounded-full ${isOnline ? 'bg-emerald-400 animate-pulse' : 'bg-rose-500'}`} />\r\n                        <span className=\"text-[10px] font-black uppercase tracking-widest text-white/80\">\r\n                            {isOnline ? 'System Live' : 'Connection Lost'}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-6\">\r\n                    <div className=\"text-right hidden sm:block\">\r\n                        <p className=\"text-xs font-bold text-indigo-200 uppercase\">{user?.username}</p>\r\n                        <span className={`text-[10px] px-2 py-0.5 rounded-md font-black uppercase ${user?.role === 'ADMIN' ? 'bg-rose-500 text-white' : 'bg-emerald-500 text-white'}`}>\r\n                            {user?.role || 'Staff'}\r\n                        </span>\r\n                    </div>\r\n                    <button onClick={handleLogout} className=\"bg-rose-500 hover:bg-rose-600 px-4 py-2 rounded-lg text-xs font-black transition-all shadow-lg active:scale-95\">LOGOUT</button>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"p-4 md:p-8 max-w-[1700px] mx-auto space-y-8\">\r\n                {/* TOP STATS CARDS */}\r\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                    <div className=\"bg-white p-4 rounded-xl border border-slate-200 shadow-sm\">\r\n                        <p className=\"text-[10px] font-bold text-slate-400 uppercase\">Total Capacity</p>\r\n                        <p className=\"text-2xl font-black text-slate-800\">{stats.total}</p>\r\n                    </div>\r\n                    <div className=\"bg-emerald-50 p-4 rounded-xl border border-emerald-100 shadow-sm\">\r\n                        <p className=\"text-[10px] font-bold text-emerald-600 uppercase\">Available</p>\r\n                        <p className=\"text-2xl font-black text-emerald-700\">{stats.available}</p>\r\n                    </div>\r\n                    <div className=\"bg-rose-50 p-4 rounded-xl border border-rose-100 shadow-sm\">\r\n                        <p className=\"text-[10px] font-bold text-rose-600 uppercase\">Occupied</p>\r\n                        <p className=\"text-2xl font-black text-rose-700\">{stats.occupied}</p>\r\n                    </div>\r\n                    <div className=\"bg-amber-50 p-4 rounded-xl border border-amber-100 shadow-sm\">\r\n                        <p className=\"text-[10px] font-bold text-amber-600 uppercase\">Turnover/Cleaning</p>\r\n                        <p className=\"text-2xl font-black text-amber-700\">{stats.cleaning}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* SEARCH & FILTER BAR */}\r\n                <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex flex-col lg:flex-row gap-4\">\r\n                    <div className=\"relative flex-1\">\r\n                        <span className=\"absolute left-4 top-3 text-slate-400\">üîç</span>\r\n                        <input \r\n                            type=\"text\"\r\n                            placeholder=\"Find Bed, Patient, or Ward...\"\r\n                            className=\"w-full pl-12 pr-4 py-3 bg-slate-50 border-none rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none font-medium transition-all\"\r\n                            value={searchQuery}\r\n                            onChange={(e) => setSearchQuery(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                        <select \r\n                            value={selectedSpecialty}\r\n                            onChange={(e) => setSelectedSpecialty(e.target.value)}\r\n                            className=\"bg-slate-50 px-4 py-3 rounded-xl border-none font-bold text-sm text-slate-600 outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer\"\r\n                        >\r\n                            {SPECIALTY_OPTIONS.map(opt => <option key={opt} value={opt}>{opt}</option>)}\r\n                        </select>\r\n                        <button \r\n                            onClick={exportCensusToCSV}\r\n                            className=\"bg-slate-800 hover:bg-slate-900 text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-md active:scale-95 text-sm\"\r\n                        >\r\n                            <span>üìä</span> <span className=\"hidden sm:inline\">Export</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* MAIN GRID */}\r\n                <div className=\"grid grid-cols-1 xl:grid-cols-12 gap-8\">\r\n                    {/* LEFT CONTENT: BEDS */}\r\n                    <div className=\"xl:col-span-8 space-y-8\">\r\n                        <section>\r\n                            <div className=\"flex justify-between items-end mb-6\">\r\n                                <div>\r\n                                    <h2 className=\"text-2xl font-black text-slate-900\">Bed Inventory</h2>\r\n                                    <p className=\"text-sm text-slate-400 font-medium\">Tracking {filteredBeds.length} units in {selectedSpecialty} sector</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {isLoading ? (\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                                    {[1, 2, 3].map(i => <div key={i} className=\"h-64 bg-slate-200 animate-pulse rounded-2xl\" />)}\r\n                                </div>\r\n                            ) : (\r\n                                <>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                                        {visibleBeds.map(bed => (\r\n                                            <BedCard \r\n                                                key={bed.bed_id} \r\n                                                bedData={bed} \r\n                                                onStatusChange={() => fetchBedData(selectedSpecialty)}\r\n                                                token={token}\r\n                                                userRole={user?.role}\r\n                                            />\r\n                                        ))}\r\n                                    </div>\r\n                                    \r\n                                    <div className=\"mt-10 flex justify-center\">\r\n                                        {filteredBeds.length > BED_LIMIT && (\r\n                                            <button \r\n                                                onClick={() => setShowAll(!showAll)}\r\n                                                className=\"bg-white border-2 border-indigo-100 text-indigo-600 px-12 py-3 rounded-full font-black hover:bg-indigo-50 transition-all shadow-sm\"\r\n                                            >\r\n                                                {showAll ? 'SHOW LESS' : `VIEW ALL ${filteredBeds.length} BEDS`}\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                </>\r\n                            )}\r\n                        </section>\r\n\r\n                        {user?.role === 'ADMIN' && <AdminTools token={token} />}\r\n                    </div>\r\n\r\n                    {/* RIGHT SIDEBAR: FORMS & LISTS */}\r\n                    <div className=\"xl:col-span-4 space-y-8\">\r\n                        <aside className=\"sticky top-28 space-y-8\">\r\n                            <AddBedForm onBedAdded={() => fetchBedData(selectedSpecialty)} specialties={SPECIALTY_OPTIONS} />\r\n                            <TransferRequestForm />\r\n                            <TransferRequestList />\r\n                        </aside>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n        {showSessionModal && (\r\n            <div className=\"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4\">\r\n                <div className=\"bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center border border-slate-100\">\r\n                    <div className=\"text-4xl mb-4\">üîë</div>\r\n                    <h2 className=\"text-xl font-black text-slate-800 mb-2\">Session Expired</h2>\r\n                    <p className=\"text-sm text-slate-500 mb-6\">For your security, you have been logged out. Please sign in again to continue managing beds.</p>\r\n                    <button \r\n                        onClick={() => window.location.href = '/'} \r\n                        className=\"w-full bg-indigo-600 text-white py-3 rounded-xl font-black hover:bg-indigo-700 transition-all shadow-lg\"\r\n                    >\r\n                    RETURN TO LOGIN\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        )}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default DashboardPage;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3022, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/pages/SignupPage.jsx"],"sourcesContent":["// frontend/src/pages/SignupPage.jsx\r\nimport React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\n\r\n// Normalize API base (accept either host or host + /api/v1 in env)\r\nconst _RAW_API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\nconst API_BASE = /\\/api\\/v1\\/?$/.test(_RAW_API) ? _RAW_API.replace(/\\/$/, '') : _RAW_API.replace(/\\/$/, '') + '/api/v1';\r\n\r\nconst SignupPage = () => {\r\n    const [formData, setFormData] = useState({\r\n        username: '',\r\n        password: '',\r\n        confirmPassword: '', // New field\r\n        role: 'STAFF'\r\n    });\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const handleChange = (e) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleSignup = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        // 1. Client-side Validation: Check if passwords match\r\n        if (formData.password !== formData.confirmPassword) {\r\n            return setError('Passwords do not match.');\r\n        }\r\n\r\n        // 2. Client-side Validation: Minimum length check\r\n        if (formData.password.length < 6) {\r\n            return setError('Password must be at least 6 characters long.');\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            await axios.post(`${API_BASE}/auth/signup`, {\r\n                username: formData.username,\r\n                password: formData.password,\r\n                role: formData.role\r\n            });\r\n\r\n            // Auto-login after signup for a smoother flow\r\n            try {\r\n                const loginRes = await axios.post(`${API_BASE}/auth/login`, {\r\n                    username: formData.username,\r\n                    password: formData.password\r\n                });\r\n                const { token, user } = loginRes.data;\r\n                localStorage.setItem('authToken', token);\r\n                localStorage.setItem('user', JSON.stringify(user));\r\n                localStorage.setItem('userRole', user.role);\r\n                navigate('/dashboard');\r\n            } catch (loginErr) {\r\n                // Signup succeeded but auto-login failed ‚Äî fallback to login page\r\n                console.warn('Auto-login failed after signup', loginErr);\r\n                alert('Account created. Please log in.');\r\n                navigate('/');\r\n            }\r\n\r\n        } catch (err) {\r\n            setError(err.response?.data?.error || 'Registration failed.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-slate-50 px-4\">\r\n            <div className=\"max-w-md w-full bg-white rounded-xl shadow-lg p-8 border border-slate-200\">\r\n                <div className=\"text-center mb-8\">\r\n                    <h1 className=\"text-3xl font-bold text-slate-900\">Staff Registration</h1>\r\n                    <p className=\"text-slate-500 mt-2\">No Bed Syndrome Tracker</p>\r\n                </div>\r\n\r\n                {error && (\r\n                    <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded text-sm font-medium animate-pulse\">\r\n                        ‚ö†Ô∏è {error}\r\n                    </div>\r\n                )}\r\n\r\n                <form onSubmit={handleSignup} className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold text-slate-700 mb-1\">Username</label>\r\n                        <input\r\n                            name=\"username\"\r\n                            type=\"text\"\r\n                            required\r\n                            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\r\n                            placeholder=\"e.g. jdoe_admin\"\r\n                            onChange={handleChange}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold text-slate-700 mb-1\">Password</label>\r\n                        <input\r\n                            name=\"password\"\r\n                            type=\"password\"\r\n                            required\r\n                            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\r\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n                            onChange={handleChange}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold text-slate-700 mb-1\">Confirm Password</label>\r\n                        <input\r\n                            name=\"confirmPassword\"\r\n                            type=\"password\"\r\n                            required\r\n                            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\r\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n                            onChange={handleChange}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold text-slate-700 mb-1\">Access Level</label>\r\n                        <select \r\n                            name=\"role\"\r\n                            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white\"\r\n                            onChange={handleChange}\r\n                        >\r\n                            <option value=\"STAFF\">Clinical Staff</option>\r\n                            <option value=\"ADMIN\">Bed Manager / Admin</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={loading}\r\n                        className={`w-full py-3 rounded-lg font-bold text-white transition-all ${\r\n                            loading ? 'bg-slate-400' : 'bg-blue-600 hover:bg-blue-700'\r\n                        }`}\r\n                    >\r\n                        {loading ? 'Processing...' : 'Create Account'}\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"mt-6 text-center text-sm\">\r\n                    <span className=\"text-slate-600\">Already have an account? </span>\r\n                    <Link to=\"/\" className=\"text-blue-600 font-bold hover:underline\">Log In</Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SignupPage;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3331, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/pages/ForgotPasswordPage.jsx"],"sourcesContent":["// frontend/src/pages/ForgotPasswordPage.jsx\r\nimport React, { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst ForgotPasswordPage = () => {\r\n    const [submitted, setSubmitted] = useState(false);\r\n    const [username, setUsername] = useState('');\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        // Here you would typically call: axios.post('/api/v1/auth/reset-request', { username })\r\n        setSubmitted(true);\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-slate-50\">\r\n            <div className=\"bg-white p-8 rounded-xl shadow-lg w-96 border border-slate-200\">\r\n                <h2 className=\"text-2xl font-bold text-slate-900 mb-4\">Reset Password</h2>\r\n                \r\n                {!submitted ? (\r\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                        <p className=\"text-sm text-slate-600\">Enter your username or ID to request a password reset.</p>\r\n                        <input \r\n                            type=\"text\" required\r\n                            placeholder=\"Username / Staff ID\"\r\n                            className=\"w-full p-2 border rounded-lg outline-none focus:ring-2 focus:ring-indigo-500\"\r\n                            onChange={(e) => setUsername(e.target.value)}\r\n                        />\r\n                        <button className=\"w-full bg-indigo-600 text-white py-2 rounded-lg font-bold hover:bg-indigo-700\">\r\n                            Send Request\r\n                        </button>\r\n                    </form>\r\n                ) : (\r\n                    <div className=\"text-center space-y-4\">\r\n                        <div className=\"bg-green-100 text-green-700 p-3 rounded-lg text-sm\">\r\n                            Request received for <strong>{username}</strong>.\r\n                        </div>\r\n                        <p className=\"text-sm text-slate-600\">\r\n                            Please contact your **Shift Lead** or **IT Admin** to finalize your password reset.\r\n                        </p>\r\n                    </div>\r\n                )}\r\n                \r\n                <div className=\"mt-6 text-center\">\r\n                    <Link to=\"/\" className=\"text-indigo-600 text-sm font-medium hover:underline\">\r\n                        ‚Üê Back to Login\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ForgotPasswordPage;"],"names":[],"mappings":";;;;;AAAA,4CAA4C;AAC5C;AACA;;;;AAEA,MAAM,qBAAqB;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IAEzC,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,wFAAwF;QACxF,aAAa;IACjB;IAEA,qBACI,qKAAC;QAAI,WAAU;kBACX,cAAA,qKAAC;YAAI,WAAU;;8BACX,qKAAC;oBAAG,WAAU;8BAAyC;;;;;;gBAEtD,CAAC,0BACE,qKAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACpC,qKAAC;4BAAE,WAAU;sCAAyB;;;;;;sCACtC,qKAAC;4BACG,MAAK;4BAAO,QAAQ;4BACpB,aAAY;4BACZ,WAAU;4BACV,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;sCAE/C,qKAAC;4BAAO,WAAU;sCAAgF;;;;;;;;;;;6EAKtG,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAI,WAAU;;gCAAqD;8CAC3C,qKAAC;8CAAQ;;;;;;gCAAkB;;;;;;;sCAEpD,qKAAC;4BAAE,WAAU;sCAAyB;;;;;;;;;;;;8BAM9C,qKAAC;oBAAI,WAAU;8BACX,cAAA,qKAAC,0MAAI;wBAAC,IAAG;wBAAI,WAAU;kCAAsD;;;;;;;;;;;;;;;;;;;;;;AAOjG;uCAEe"}},
    {"offset": {"line": 3469, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arnoc/Desktop/No%20Bed%20Syndrome/no-bed-syndrome-tracker/frontend/src/App.tsx"],"sourcesContent":["// frontend/src/App.tsx\r\n\r\nimport React, { PropsWithChildren } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\r\n\r\n// Import Pages\r\nimport LoginPage from './pages/LoginPage';\r\nimport DashboardPage from './pages/DashboardPage';\r\nimport SignupPage from './pages/SignupPage';\r\nimport ForgotPasswordPage from './pages/ForgotPasswordPage';\r\n\r\n// --- Private Route Component ---\r\n// This component checks if a token exists before allowing access\r\nconst PrivateRoute: React.FC<PropsWithChildren<{}>> = ({ children }) => {\r\n    if (typeof window === 'undefined') return <Navigate to=\"/\" />;\r\n\r\n    const token = localStorage.getItem('authToken');\r\n\r\n    // No token -> redirect to login\r\n    if (!token) return <Navigate to=\"/\" replace />;\r\n\r\n    // Try to validate token expiry (if it's a JWT)\r\n    try {\r\n        const parts = token.split('.');\r\n        if (parts.length === 3) {\r\n            const payload = JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));\r\n            if (payload.exp && typeof payload.exp === 'number') {\r\n                const now = Math.floor(Date.now() / 1000);\r\n                if (payload.exp < now) {\r\n                    // token expired\r\n                    localStorage.removeItem('authToken');\r\n                    localStorage.removeItem('user');\r\n                    localStorage.removeItem('userRole');\r\n                    return <Navigate to=\"/\" replace />;\r\n                }\r\n            }\r\n        }\r\n    } catch (e) {\r\n        // malformed token: clear and redirect\r\n        localStorage.removeItem('authToken');\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('userRole');\r\n        return <Navigate to=\"/\" replace />;\r\n    }\r\n\r\n    return <>{children}</>;\r\n};\r\n\r\nconst App: React.FC = () => {\r\n    return (\r\n        <Router>\r\n            <Routes>\r\n                {/* 1. Login Page: Accessible to everyone at the root path */}\r\n                <Route path=\"/\" element={<LoginPage />} />\r\n                <Route path=\"/forgot-password\" element={<ForgotPasswordPage />} />\r\n                <Route path=\"/signup\" element={<SignupPage />} />\r\n\r\n                {/* 2. Dashboard Page: Protected route */}\r\n                <Route \r\n                    path=\"/dashboard\" \r\n                    element={\r\n                        <PrivateRoute>\r\n                            <DashboardPage />\r\n                        </PrivateRoute>\r\n                    } \r\n                />\r\n                \r\n                {/* 3. Catch-all for 404s */}\r\n                <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n            </Routes>\r\n        </Router>\r\n    );\r\n};\r\n\r\nexport default App;\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;AAGvB;AAEA,eAAe;AACf;AACA;AACA;AACA;;;;;;;;;;;;;AAEA,kCAAkC;AAClC,iEAAiE;AACjE,MAAM,eAAgD,CAAC,EAAE,QAAQ,EAAE;IAC/D,wCAAmC,qBAAO,qKAAC,8MAAQ;QAAC,IAAG;;;;;;;;IAEvD,MAAM;AA8BV;AAEA,MAAM,MAAgB;IAClB,qBACI,qKAAC,mNAAM;kBACH,cAAA,qKAAC,4MAAM;;8BAEH,qKAAC,2MAAK;oBAAC,MAAK;oBAAI,uBAAS,qKAAC,8HAAS;;;;;;;;;;8BACnC,qKAAC,2MAAK;oBAAC,MAAK;oBAAmB,uBAAS,qKAAC,uIAAkB;;;;;;;;;;8BAC3D,qKAAC,2MAAK;oBAAC,MAAK;oBAAU,uBAAS,qKAAC,+HAAU;;;;;;;;;;8BAG1C,qKAAC,2MAAK;oBACF,MAAK;oBACL,uBACI,qKAAC;kCACG,cAAA,qKAAC,kIAAa;;;;;;;;;;;;;;;8BAM1B,qKAAC,2MAAK;oBAAC,MAAK;oBAAI,uBAAS,qKAAC,8MAAQ;wBAAC,IAAG;;;;;;;;;;;;;;;;;;;;;;AAItD;uCAEe"}}]
}